<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zachary Neal, Michigan State University, zpneal@msu.edu" />


<title>Backbone Unit Tests</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Backbone Unit Tests</h1>
<h4 class="author">Zachary Neal, Michigan State University, <a href="mailto:zpneal@msu.edu" class="email">zpneal@msu.edu</a></h4>



<div id="toc" class="section level1">
<h1>Table of Contents</h1>
<ol style="list-style-type: decimal">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#projection"><code>backbone_from_projection()</code></a>
<ol style="list-style-type: lower-alpha">
<li><a href="#projection-matrix">From matrix</a></li>
<li><a href="#projection-igraph">From igraph</a></li>
</ol></li>
<li><a href="#weighted"><code>backbone_from_weighted()</code></a>
<ol style="list-style-type: lower-alpha">
<li><a href="#weighted-matrix">From weighted matrix</a></li>
<li><a href="#weighted-igraph">From weighted igraph</a></li>
<li><a href="#weighted-projection">From weighted projection</a></li>
<li><a href="#weighted-igraph-projection">From weighted igraph
projection</a></li>
</ol></li>
<li><a href="#unweighted"><code>backbone_from_unweighted()</code></a>
<ol style="list-style-type: lower-alpha">
<li><a href="#unweighted-escore"><code>.escore()</code></a></li>
<li><a href="#unweighted-normalize"><code>.normalize()</code></a></li>
<li><a href="#unweighted-filter"><code>.filter()</code></a></li>
<li><a href="#unweighted-models">Models</a></li>
</ol></li>
<li><a href="#null">Null model functions</a></li>
<li><a href="#utility">Utility functions</a></li>
</ol>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The “vignette” is designed solely to display the automated unit tests
used to evaluate the <code>backbone</code> package. To identify any
failed unit tests, search in the vignette for the word “failed”.</p>
<p>For a general introduction to the backbone package, please see the <a href="../doc/backbone.html">Introduction to Backbone</a> vignette. Or,
for a complete example using empirical data, please see the <a href="../doc/senate.html">Empirical Example of Backbone Extraction</a>
vignette.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(backbone)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tinytest)</span></code></pre></div>
<p><a href="#toc">back to Table of Contents</a></p>
</div>
<div id="projection" class="section level1">
<h1><code>backbone_from_projection()</code></h1>
<div id="projection-setup" class="section level2">
<h2>Setup</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>trace <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">diag</span>(x))}</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>matcube <span class="ot">&lt;-</span> <span class="cf">function</span>(x){x<span class="sc">%*%</span>x<span class="sc">%*%</span>x}</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>triangle_index <span class="ot">&lt;-</span> <span class="cf">function</span>(x){(<span class="fu">trace</span>(<span class="fu">matcube</span>(x)) <span class="sc">+</span> <span class="fu">trace</span>(<span class="fu">matcube</span>(<span class="fu">abs</span>(x))))<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">trace</span>(<span class="fu">matcube</span>(<span class="fu">abs</span>(x))))}</span></code></pre></div>
</div>
<div id="projection-matrix" class="section level2">
<h2>From matrix</h2>
<div id="sdsm-matrix" class="section level3">
<h3>SDSM</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),   <span class="co">#An example block incidence matrix</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>)))</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract SDSM matrix, return everything</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">6</span>)  <span class="co">#Returned object contains six elements</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 6)</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>bipartite,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$bipartite, &quot;matrix&quot;))</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>projection,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$projection, &quot;matrix&quot;))</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>backbone,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$backbone, &quot;matrix&quot;))</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$pvalues$upper, &quot;matrix&quot;))</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$narrative, &quot;character&quot;))</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$call, &quot;call&quot;))</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(Matrix<span class="sc">::</span><span class="fu">Matrix</span>(B), <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract SDSM Matrix, return everything</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">6</span>)  <span class="co">#Returned object contains six elements</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 6)</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>bipartite,<span class="st">&quot;Matrix&quot;</span>))</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$bipartite, &quot;Matrix&quot;))</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>projection,<span class="st">&quot;Matrix&quot;</span>))</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$projection, &quot;Matrix&quot;))</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>backbone,<span class="st">&quot;Matrix&quot;</span>))</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$backbone, &quot;Matrix&quot;))</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$pvalues$upper, &quot;matrix&quot;))</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$narrative, &quot;character&quot;))</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$call, &quot;call&quot;))</span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>)  <span class="co">#Extract SDSM matrix as signed</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="fdsm-matrix" class="section level3">
<h3>FDSM</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fdsm&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">trials =</span> <span class="dv">250</span>)  <span class="co">#Extract FDSM matrix as signed</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; Constructing edges&#39; Monte Carlo p-values</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="fixedrow-matrix" class="section level3">
<h3>fixedrow</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedrow&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>)  <span class="co">#Extract fixedrow matrix as signed</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="fixedfill-matrix" class="section level3">
<h3>fixedcol</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedcol&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>)  <span class="co">#Extract fixedcol matrix as signed</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="fixedfill-matrix" class="section level3">
<h3>fixedfill</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedfill&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>)  <span class="co">#Extract fixedfill matrix as signed</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="sdsmec-matrix" class="section level3">
<h3>SDSM-EC</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(B)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>make_prohibited <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">0</span>), <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co">#Pick some missing edges to prohibit</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>B[make_prohibited] <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>make_required <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">1</span>), <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co">#Pick some present edges to require</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>B[make_required] <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(B, <span class="dv">30</span>, <span class="dv">75</span>)  <span class="co">#Reassemble as matrix</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>)  <span class="co">#Extract SDSM matrix as signed, considering structural values</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
</div>
<div id="projection-igraph" class="section level2">
<h2>From igraph</h2>
<div id="sdsm-igraph" class="section level3">
<h3>SDSM</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),   <span class="co">#An example block incidence matrix</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>)))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">graph_from_biadjacency_matrix</span>(B)          <span class="co">#Convert to igraph</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">V</span>(B)<span class="sc">$</span>agent_attrib <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>),<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">75</span>))     <span class="co">#Add agent attribute</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="fu">V</span>(B)<span class="sc">$</span>artifact_attrib <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">30</span>),<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">75</span>))  <span class="co">#Add artifact attribute</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract SDSM igraph, return everything</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">6</span>)  <span class="co">#Returned object contains six elements</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 6)</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>bipartite)[<span class="dv">1</span>],<span class="st">&quot;igraph&quot;</span>)</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$bipartite)[1], &quot;igraph&quot;)</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_bipartite</span>(bb<span class="sc">$</span>bipartite))</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_bipartite(bb$bipartite))</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>projection)[<span class="dv">1</span>],<span class="st">&quot;igraph&quot;</span>)</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$projection)[1], &quot;igraph&quot;)</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="fu">expect_false</span>(<span class="fu">is_directed</span>(bb<span class="sc">$</span>projection))</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(is_directed(bb$projection))</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>backbone)[<span class="dv">1</span>],<span class="st">&quot;igraph&quot;</span>)</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$backbone)[1], &quot;igraph&quot;)</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="fu">expect_false</span>(<span class="fu">is_directed</span>(bb<span class="sc">$</span>backbone))</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(is_directed(bb$backbone))</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper)[<span class="dv">1</span>],<span class="st">&quot;matrix&quot;</span>)</span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$pvalues$upper)[1], &quot;matrix&quot;)</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>narrative)[<span class="dv">1</span>],<span class="st">&quot;character&quot;</span>)</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$narrative)[1], &quot;character&quot;)</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>call)[<span class="dv">1</span>],<span class="st">&quot;call&quot;</span>)</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$call)[1], &quot;call&quot;)</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>)                              <span class="co">#Extract SDSM igraph with defaults</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="fdsm-igraph" class="section level3">
<h3>FDSM</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fdsm&quot;</span>, <span class="at">trials =</span> <span class="dv">250</span>)                <span class="co">#Extract FDSM igraph with defaults</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Constructing edges&#39; Monte Carlo p-values</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="fixedrow-igraph" class="section level3">
<h3>fixedrow</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedrow&quot;</span>)                          <span class="co">#Extract fixedrow igraph with defaults</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="fixedfill-igraph" class="section level3">
<h3>fixedcol</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedrow&quot;</span>)                          <span class="co">#Extract fixedcol igraph with defaults</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="fixedfill-igraph" class="section level3">
<h3>fixedfill</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;fixedfill&quot;</span>)                         <span class="co">#Extract fixedcol igraph with defaults</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="sdsmec-igraph" class="section level3">
<h3>SDSM-EC</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">E</span>(B)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">E</span>(B)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">11</span>), <span class="fu">length</span>(<span class="fu">E</span>(B)<span class="sc">$</span>weight), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">1</span>))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_projection</span>(B, <span class="at">model =</span> <span class="st">&quot;sdsm&quot;</span>)                              <span class="co">#Extract SDSM igraph with defaults, considering structural values</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="weighted" class="section level1">
<h1><code>backbone_from_weighted()</code></h1>
<div id="weighted-matrix" class="section level2">
<h2>From weighted matrix</h2>
<div id="disparity" class="section level3">
<h3>Disparity</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">75</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>              <span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>              <span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>              <span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>              <span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>              <span class="dv">75</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">10</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">0</span>),<span class="dv">10</span>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract disparity backbone, return everything</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">5</span>)  <span class="co">#Returned object contains five elements</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 5)</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>weighted,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$weighted, &quot;matrix&quot;))</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>backbone,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$backbone, &quot;matrix&quot;))</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$pvalues$upper, &quot;matrix&quot;))</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$narrative, &quot;character&quot;))</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$call, &quot;call&quot;))</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(Matrix<span class="sc">::</span><span class="fu">Matrix</span>(W), <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract disparity backbone, return everything</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">5</span>)  <span class="co">#Returned object contains five elements</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 5)</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>weighted,<span class="st">&quot;Matrix&quot;</span>))</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$weighted, &quot;Matrix&quot;))</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>backbone,<span class="st">&quot;Matrix&quot;</span>))</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$backbone, &quot;Matrix&quot;))</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper,<span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$pvalues$upper, &quot;matrix&quot;))</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$narrative, &quot;character&quot;))</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))</span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb$call, &quot;call&quot;))</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>)  <span class="co">#Extract disparity backbone</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))                          <span class="co">#Returns as matrix</span></span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(bb, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="lans" class="section level3">
<h3>LANS</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;lans&quot;</span>)       <span class="co">#Extract lans backbone</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))                          <span class="co">#Returns as matrix</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(bb, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="mlf" class="section level3">
<h3>MLF</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;mlf&quot;</span>)        <span class="co">#Extract mlf backbone</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))                          <span class="co">#Returns as matrix</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(bb, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="global" class="section level3">
<h3>Global</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>)     <span class="co">#Extract global backbone (unsigned)</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))                          <span class="co">#Returns as matrix</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">table</span>(bb)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">58</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">42</span>)      <span class="co">#Contains 58 0s and 42 1s</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(table(bb)[1] == 58 &amp; table(bb)[2] == 42)</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>, <span class="at">parameter =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">74</span>))     <span class="co">#Extract global backbone (signed)</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">table</span>(bb)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">12</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">78</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">3</span>]<span class="sc">==</span><span class="dv">10</span>)      <span class="co">#Contains 12 -1s, 78 0s, and 10 1s</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(table(bb)[1] == 12 &amp; table(bb)[2] == 78 &amp; table(bb)[3] == </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;  call| 10)</span></span></code></pre></div>
</div>
</div>
<div id="weighted-igraph" class="section level2">
<h2>From weighted igraph</h2>
<div id="disparity-1" class="section level3">
<h3>Disparity</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(W, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>, <span class="at">weighted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>)  <span class="co">#Extract disparity backbone</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                          <span class="co">#Returns as igraph</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="lans-1" class="section level3">
<h3>LANS</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;lans&quot;</span>)       <span class="co">#Extract lans backbone</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                          <span class="co">#Returns as igraph</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="mlf-1" class="section level3">
<h3>MLF</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;mlf&quot;</span>)        <span class="co">#Extract mlf backbone</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                          <span class="co">#Returns as igraph</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is_tree</span>(bb))                      <span class="co">#Backbone is a tree</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is_tree(bb))</span></span></code></pre></div>
</div>
<div id="global-1" class="section level3">
<h3>Global</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>)     <span class="co">#Extract global backbone (unsigned)</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                          <span class="co">#Returns as matrix</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(bb, <span class="at">sparse =</span> <span class="cn">FALSE</span>)   <span class="co">#Get matrix</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">table</span>(bb)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">58</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">42</span>)      <span class="co">#Contains 58 0s and 42 1s</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(table(bb)[1] == 58 &amp; table(bb)[2] == 42)</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>, <span class="at">parameter =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">74</span>))     <span class="co">#Extract global backbone (signed)</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(bb, <span class="at">sparse =</span> <span class="cn">FALSE</span>, <span class="at">attr =</span> <span class="st">&quot;sign&quot;</span>)   <span class="co">#Get matrix</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">table</span>(bb)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">12</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">78</span> <span class="sc">&amp;</span> <span class="fu">table</span>(bb)[<span class="dv">3</span>]<span class="sc">==</span><span class="dv">10</span>)      <span class="co">#Contains 12 -1s, 78 0s, and 10 1s</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(table(bb)[1] == 12 &amp; table(bb)[2] == 78 &amp; table(bb)[3] == </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;  call| 10)</span></span></code></pre></div>
</div>
</div>
<div id="weighted-projection" class="section level2">
<h2>From weighted projection</h2>
<div id="disparity-2" class="section level3">
<h3>Disparity</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>)))</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> W<span class="sc">%*%</span><span class="fu">t</span>(W)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="fu">diag</span>(W) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)  <span class="co">#Extract signed disparity matrix</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="lans-2" class="section level3">
<h3>LANS</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;lans&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)  <span class="co">#Extract signed lans matrix</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="mlf-2" class="section level3">
<h3>MLF</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;mlf&quot;</span>, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)  <span class="co">#Extract signed mlf matrix</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
<div id="global-2" class="section level3">
<h3>Global</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">mean</span>(W) <span class="sc">+</span> <span class="fu">sd</span>(W)             <span class="co">#Use mean + sd as positive edge threshold</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">mean</span>(W) <span class="sc">-</span> <span class="fu">sd</span>(W)             <span class="co">#Use mean - sd as negative edge threshold</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>, <span class="at">parameter =</span> <span class="fu">c</span>(lower, upper))  <span class="co">#Extract signed global matrix</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;matrix&quot;</span>))         <span class="co">#Returns as matrix</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;matrix&quot;))</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#Contains only -1, 0, 1</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(bb %in% c(-1, 0, 1)))</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)))      <span class="co">#Contains some negative edges</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(-1)))</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))       <span class="co">#Contains some missing edges</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(0)))</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">any</span>(bb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)))       <span class="co">#Contains some positive edges</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(any(bb %in% c(1)))</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="fu">triangle_index</span>(bb)</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; [1] 0.9918367</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">triangle_index</span>(bb)<span class="sc">&gt;</span>.<span class="dv">8</span>)   <span class="co">#Is nearly balanced</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(triangle_index(bb) &gt; 0.8)</span></span></code></pre></div>
</div>
</div>
<div id="weighted-igraph-projection" class="section level2">
<h2>From weighted igraph projection</h2>
<div id="disparity-3" class="section level3">
<h3>Disparity</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>),</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>)),</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>           <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">15</span>),<span class="dv">10</span>),</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>                 <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">250</span>,<span class="dv">1</span>,.<span class="dv">85</span>),<span class="dv">10</span>)))</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">graph_from_biadjacency_matrix</span>(W)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">bipartite_projection</span>(W, <span class="at">which =</span> <span class="st">&quot;false&quot;</span>)</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="fu">V</span>(W)<span class="sc">$</span>agent_attrib <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))     <span class="co">#Add agent attribute</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)  <span class="co">#Extract disparity igraph, return everything</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">length</span>(bb),<span class="dv">5</span>)  <span class="co">#Returned object contains five elements</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(length(bb), 5)</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>weighted)[<span class="dv">1</span>],<span class="st">&quot;igraph&quot;</span>)</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$weighted)[1], &quot;igraph&quot;)</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>backbone)[<span class="dv">1</span>],<span class="st">&quot;igraph&quot;</span>)</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$backbone)[1], &quot;igraph&quot;)</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>pvalues<span class="sc">$</span>upper)[<span class="dv">1</span>],<span class="st">&quot;matrix&quot;</span>)</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$pvalues$upper)[1], &quot;matrix&quot;)</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>narrative)[<span class="dv">1</span>],<span class="st">&quot;character&quot;</span>)</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$narrative)[1], &quot;character&quot;)</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">class</span>(bb<span class="sc">$</span>call)[<span class="dv">1</span>],<span class="st">&quot;call&quot;</span>)</span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(class(bb$call)[1], &quot;call&quot;)</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;disparity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)            <span class="co">#Extract unweighted disparity igraph</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb27-45"><a href="#cb27-45" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb27-46"><a href="#cb27-46" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb27-47"><a href="#cb27-47" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="lans-3" class="section level3">
<h3>LANS</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;lans&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)                 <span class="co">#Extract unweighted lans igraph</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="mlf-3" class="section level3">
<h3>MLF</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;mlf&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)                  <span class="co">#Extract unweighted mlf igraph</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
<div id="global-3" class="section level3">
<h3>Global</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">E</span>(W)<span class="sc">$</span>weight) <span class="sc">+</span> <span class="fu">sd</span>(<span class="fu">E</span>(W)<span class="sc">$</span>weight)              <span class="co">#Use mean + sd as edge threshold</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">backbone_from_weighted</span>(W, <span class="at">model =</span> <span class="st">&quot;global&quot;</span>, <span class="at">parameter =</span> threshold)      <span class="co">#Extract unweighted global igraph</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(bb,<span class="st">&quot;igraph&quot;</span>))                                                  <span class="co">#Returns as igraph</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(bb, &quot;igraph&quot;))</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">vertex_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;agent_attrib&quot;</span>))            <span class="co">#Contains correct vertex attributes</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(vertex_attr_names(bb), c(&quot;agent_attrib&quot;))</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="fu">expect_identical</span>(<span class="fu">edge_attr_names</span>(bb), <span class="fu">c</span>(<span class="st">&quot;oldweight&quot;</span>))                 <span class="co">#Contains correct edge attributes</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt;  call| expect_identical(edge_attr_names(bb), c(&quot;oldweight&quot;))</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">modularity</span>(bb, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(modularity(bb, c(rep(1, 10), rep(2, 10), rep(3, 10))) &gt; </span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt;  call| 0.5)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="unweighted" class="section level1">
<h1><code>backbone_from_unweighted()</code></h1>
<div id="unweighted-escore" class="section level2">
<h2><code>.escore()</code></h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),<span class="dv">10</span>,<span class="dv">10</span>)  <span class="co">#A binary, square, symmetric matrix</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">diag</span>(A) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">pmax</span>(A, <span class="fu">t</span>(A))</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;random&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;betweenness&quot;</span>)</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span>))  <span class="co">#All values are 0 or larger</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0))</span></span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;triangles&quot;</span>)</span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-39"><a href="#cb31-39" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-40"><a href="#cb31-40" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>))  <span class="co">#All values are integers</span></span>
<span id="cb31-41"><a href="#cb31-41" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-42"><a href="#cb31-42" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test%%1 == 0))</span></span>
<span id="cb31-43"><a href="#cb31-43" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-44"><a href="#cb31-44" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-45"><a href="#cb31-45" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-46"><a href="#cb31-46" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;jaccard&quot;</span>)</span>
<span id="cb31-48"><a href="#cb31-48" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-49"><a href="#cb31-49" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-50"><a href="#cb31-50" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-51"><a href="#cb31-51" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-52"><a href="#cb31-52" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-53"><a href="#cb31-53" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-54"><a href="#cb31-54" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-55"><a href="#cb31-55" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-56"><a href="#cb31-56" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-57"><a href="#cb31-57" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-58"><a href="#cb31-58" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-59"><a href="#cb31-59" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-60"><a href="#cb31-60" tabindex="-1"></a></span>
<span id="cb31-61"><a href="#cb31-61" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;dice&quot;</span>)</span>
<span id="cb31-62"><a href="#cb31-62" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-63"><a href="#cb31-63" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-64"><a href="#cb31-64" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-65"><a href="#cb31-65" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-66"><a href="#cb31-66" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-67"><a href="#cb31-67" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-68"><a href="#cb31-68" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-69"><a href="#cb31-69" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-70"><a href="#cb31-70" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-71"><a href="#cb31-71" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-72"><a href="#cb31-72" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-73"><a href="#cb31-73" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-74"><a href="#cb31-74" tabindex="-1"></a></span>
<span id="cb31-75"><a href="#cb31-75" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;quadrangles&quot;</span>)</span>
<span id="cb31-76"><a href="#cb31-76" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-77"><a href="#cb31-77" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-78"><a href="#cb31-78" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-79"><a href="#cb31-79" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-80"><a href="#cb31-80" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-81"><a href="#cb31-81" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-82"><a href="#cb31-82" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>))  <span class="co">#All values are integers</span></span>
<span id="cb31-83"><a href="#cb31-83" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-84"><a href="#cb31-84" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test%%1 == 0))</span></span>
<span id="cb31-85"><a href="#cb31-85" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-86"><a href="#cb31-86" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-87"><a href="#cb31-87" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-88"><a href="#cb31-88" tabindex="-1"></a></span>
<span id="cb31-89"><a href="#cb31-89" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;quadrilateral&quot;</span>)</span>
<span id="cb31-90"><a href="#cb31-90" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-91"><a href="#cb31-91" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-92"><a href="#cb31-92" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-93"><a href="#cb31-93" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-94"><a href="#cb31-94" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-95"><a href="#cb31-95" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-96"><a href="#cb31-96" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-97"><a href="#cb31-97" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-98"><a href="#cb31-98" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-99"><a href="#cb31-99" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-100"><a href="#cb31-100" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-101"><a href="#cb31-101" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-102"><a href="#cb31-102" tabindex="-1"></a></span>
<span id="cb31-103"><a href="#cb31-103" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;degree&quot;</span>)</span>
<span id="cb31-104"><a href="#cb31-104" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-105"><a href="#cb31-105" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-106"><a href="#cb31-106" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-107"><a href="#cb31-107" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>))  <span class="co">#All values are integers</span></span>
<span id="cb31-108"><a href="#cb31-108" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-109"><a href="#cb31-109" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test%%1 == 0))</span></span>
<span id="cb31-110"><a href="#cb31-110" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-111"><a href="#cb31-111" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-112"><a href="#cb31-112" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-113"><a href="#cb31-113" tabindex="-1"></a></span>
<span id="cb31-114"><a href="#cb31-114" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;meetmin&quot;</span>)</span>
<span id="cb31-115"><a href="#cb31-115" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-116"><a href="#cb31-116" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-117"><a href="#cb31-117" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-118"><a href="#cb31-118" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-119"><a href="#cb31-119" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-120"><a href="#cb31-120" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-121"><a href="#cb31-121" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-122"><a href="#cb31-122" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-123"><a href="#cb31-123" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-124"><a href="#cb31-124" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-125"><a href="#cb31-125" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-126"><a href="#cb31-126" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-127"><a href="#cb31-127" tabindex="-1"></a></span>
<span id="cb31-128"><a href="#cb31-128" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;geometric&quot;</span>)</span>
<span id="cb31-129"><a href="#cb31-129" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-130"><a href="#cb31-130" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-131"><a href="#cb31-131" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-132"><a href="#cb31-132" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-133"><a href="#cb31-133" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-134"><a href="#cb31-134" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-135"><a href="#cb31-135" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-136"><a href="#cb31-136" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-137"><a href="#cb31-137" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-138"><a href="#cb31-138" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-139"><a href="#cb31-139" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-140"><a href="#cb31-140" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span>
<span id="cb31-141"><a href="#cb31-141" tabindex="-1"></a></span>
<span id="cb31-142"><a href="#cb31-142" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.escore</span>(A, <span class="st">&quot;hypergeometric&quot;</span>)</span>
<span id="cb31-143"><a href="#cb31-143" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb31-144"><a href="#cb31-144" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-145"><a href="#cb31-145" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb31-146"><a href="#cb31-146" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb31-147"><a href="#cb31-147" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-148"><a href="#cb31-148" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb31-149"><a href="#cb31-149" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb31-150"><a href="#cb31-150" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-151"><a href="#cb31-151" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb31-152"><a href="#cb31-152" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb31-153"><a href="#cb31-153" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb31-154"><a href="#cb31-154" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A == 0] == 0))</span></span></code></pre></div>
</div>
<div id="unweighted-normalize" class="section level2">
<h2><code>.normalize()</code></h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),<span class="dv">10</span>,<span class="dv">10</span>)  <span class="co">#A weighted, square matrix</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">diag</span>(A1) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">pmax</span>(A1, <span class="fu">t</span>(A1))  <span class="co">#A weighted, square, symmetric matrix</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.normalize</span>(A1, <span class="st">&quot;rank&quot;</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>))  <span class="co">#All values are integers</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test%%1 == 0))</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 == 0] == 0))</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.normalize</span>(A2, <span class="st">&quot;rank&quot;</span>)</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>))  <span class="co">#All values are integers</span></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test%%1 == 0))</span></span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 == 0] == 0))</span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.normalize</span>(A1, <span class="st">&quot;embeddedness&quot;</span>)</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 == 0] == 0))</span></span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.normalize</span>(A2, <span class="st">&quot;embeddedness&quot;</span>)</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#All values between 0 and 1</span></span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test &gt;= 0 &amp; test &lt;= 1))</span></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 == 0] == 0))</span></span></code></pre></div>
</div>
<div id="unweighted-filter" class="section level2">
<h2><code>.filter()</code></h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">2500</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),<span class="dv">50</span>,<span class="dv">50</span>)  <span class="co">#A weighted, square matrix</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">diag</span>(A1) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> A1; A2[<span class="fu">upper.tri</span>(A2)] <span class="ot">&lt;-</span> <span class="fu">t</span>(A1)[<span class="fu">upper.tri</span>(A1)]  <span class="co">#Symmetrize using lower triangle</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A1, <span class="st">&quot;threshold&quot;</span>, <span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 == 0] == 0))</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is below threshold, it is missing in result</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 &lt;= 2] == 0))</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A2, <span class="st">&quot;threshold&quot;</span>, <span class="dv">2</span>)</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 == 0] == 0))</span></span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is below threshold, it is missing in result</span></span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 &lt;= 2] == 0))</span></span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A1, <span class="st">&quot;proportion&quot;</span>, .<span class="dv">5</span>)</span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 == 0] == 0))</span></span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a><span class="fu">sum</span>(test<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(A1<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a><span class="co">#&gt; [1] 0.5011166</span></span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a><span class="fu">expect_true</span>((<span class="fu">sum</span>(test<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(A1<span class="sc">!=</span><span class="dv">0</span>)) <span class="sc">&gt;</span> <span class="fl">0.3</span> <span class="sc">&amp;</span> (<span class="fu">sum</span>(test<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(A1<span class="sc">!=</span><span class="dv">0</span>)) <span class="sc">&lt;</span> <span class="fl">0.7</span>)  <span class="co">#Should keep 30-70% of original edges on average</span></span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a><span class="co">#&gt;  call| expect_true((sum(test != 0)/sum(A1 != 0)) &gt; 0.3 &amp; (sum(test != </span></span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a><span class="co">#&gt;  call| 0)/sum(A1 != 0)) &lt; 0.7)</span></span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A2, <span class="st">&quot;proportion&quot;</span>, .<span class="dv">5</span>)</span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test))  <span class="co">#Output is symmetric</span></span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test))</span></span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 == 0] == 0))</span></span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a><span class="fu">expect_true</span>((<span class="fu">sum</span>(test<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(A2<span class="sc">!=</span><span class="dv">0</span>)) <span class="sc">&gt;</span> <span class="fl">0.3</span> <span class="sc">&amp;</span> (<span class="fu">sum</span>(test<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(A2<span class="sc">!=</span><span class="dv">0</span>)) <span class="sc">&lt;</span> <span class="fl">0.7</span>)  <span class="co">#Should keep 30-70% of original edges on average</span></span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a><span class="co">#&gt;  call| expect_true((sum(test != 0)/sum(A2 != 0)) &gt; 0.3 &amp; (sum(test != </span></span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a><span class="co">#&gt;  call| 0)/sum(A2 != 0)) &lt; 0.7)</span></span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a></span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A1, <span class="st">&quot;degree&quot;</span>, .<span class="dv">5</span>)</span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-72"><a href="#cb33-72" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-73"><a href="#cb33-73" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-74"><a href="#cb33-74" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-75"><a href="#cb33-75" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-76"><a href="#cb33-76" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-77"><a href="#cb33-77" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-78"><a href="#cb33-78" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A1 == 0] == 0))</span></span>
<span id="cb33-79"><a href="#cb33-79" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.filter</span>(A2, <span class="st">&quot;degree&quot;</span>, .<span class="dv">5</span>)</span>
<span id="cb33-80"><a href="#cb33-80" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(test)<span class="sc">==</span><span class="dv">0</span>))  <span class="co">#Diagonal contains 0s</span></span>
<span id="cb33-81"><a href="#cb33-81" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-82"><a href="#cb33-82" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(diag(test) == 0))</span></span>
<span id="cb33-83"><a href="#cb33-83" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))  <span class="co">#All values are 0 or 1</span></span>
<span id="cb33-84"><a href="#cb33-84" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-85"><a href="#cb33-85" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test %in% c(0, 1)))</span></span>
<span id="cb33-86"><a href="#cb33-86" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test[A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">0</span>))  <span class="co">#If edge is missing in original, also missing in result</span></span>
<span id="cb33-87"><a href="#cb33-87" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb33-88"><a href="#cb33-88" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test[A2 == 0] == 0))</span></span></code></pre></div>
</div>
<div id="unweighted-models" class="section level2">
<h2>Models</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">#skeleton (no particular structure expected in backbone)</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">sample_sbm</span>(<span class="dv">60</span>, <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">75</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">75</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">75</span>),<span class="dv">3</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))  <span class="co">#Unweighted graph with three hidden communities</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;skeleton&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;skeleton&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Smaller parameter yields more sparsification</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a><span class="co">#gspar</span></span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;gspar&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;gspar&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Smaller parameter yields more sparsification</span></span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a><span class="co">#lspar</span></span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;lspar&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;lspar&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Smaller parameter yields more sparsification</span></span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a></span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a><span class="co">#simmelian</span></span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;simmelian&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;simmelian&quot;</span>, <span class="at">parameter =</span> .<span class="dv">7</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a></span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a><span class="co">#jaccard</span></span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;jaccard&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-119"><a href="#cb34-119" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-120"><a href="#cb34-120" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-121"><a href="#cb34-121" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-122"><a href="#cb34-122" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-123"><a href="#cb34-123" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-124"><a href="#cb34-124" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-125"><a href="#cb34-125" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-126"><a href="#cb34-126" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-127"><a href="#cb34-127" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-128"><a href="#cb34-128" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-129"><a href="#cb34-129" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-130"><a href="#cb34-130" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-131"><a href="#cb34-131" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-132"><a href="#cb34-132" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-133"><a href="#cb34-133" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-134"><a href="#cb34-134" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-135"><a href="#cb34-135" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-136"><a href="#cb34-136" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-137"><a href="#cb34-137" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-138"><a href="#cb34-138" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-139"><a href="#cb34-139" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;jaccard&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-140"><a href="#cb34-140" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-141"><a href="#cb34-141" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-142"><a href="#cb34-142" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-143"><a href="#cb34-143" tabindex="-1"></a></span>
<span id="cb34-144"><a href="#cb34-144" tabindex="-1"></a><span class="co">#meetmin</span></span>
<span id="cb34-145"><a href="#cb34-145" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;meetmin&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-146"><a href="#cb34-146" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-147"><a href="#cb34-147" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-148"><a href="#cb34-148" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-149"><a href="#cb34-149" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-150"><a href="#cb34-150" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-151"><a href="#cb34-151" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-152"><a href="#cb34-152" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-153"><a href="#cb34-153" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-154"><a href="#cb34-154" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-155"><a href="#cb34-155" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-156"><a href="#cb34-156" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-157"><a href="#cb34-157" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-158"><a href="#cb34-158" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-159"><a href="#cb34-159" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-160"><a href="#cb34-160" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-161"><a href="#cb34-161" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-162"><a href="#cb34-162" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-163"><a href="#cb34-163" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-164"><a href="#cb34-164" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-165"><a href="#cb34-165" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-166"><a href="#cb34-166" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-167"><a href="#cb34-167" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-168"><a href="#cb34-168" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;meetmin&quot;</span>, <span class="at">parameter =</span> .<span class="dv">7</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-169"><a href="#cb34-169" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-170"><a href="#cb34-170" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-171"><a href="#cb34-171" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-172"><a href="#cb34-172" tabindex="-1"></a></span>
<span id="cb34-173"><a href="#cb34-173" tabindex="-1"></a><span class="co">#geometric</span></span>
<span id="cb34-174"><a href="#cb34-174" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;geometric&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-175"><a href="#cb34-175" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-176"><a href="#cb34-176" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-177"><a href="#cb34-177" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-178"><a href="#cb34-178" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-179"><a href="#cb34-179" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-180"><a href="#cb34-180" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-181"><a href="#cb34-181" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-182"><a href="#cb34-182" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-183"><a href="#cb34-183" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-184"><a href="#cb34-184" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-185"><a href="#cb34-185" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-186"><a href="#cb34-186" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-187"><a href="#cb34-187" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-188"><a href="#cb34-188" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-189"><a href="#cb34-189" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-190"><a href="#cb34-190" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-191"><a href="#cb34-191" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-192"><a href="#cb34-192" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-193"><a href="#cb34-193" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-194"><a href="#cb34-194" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-195"><a href="#cb34-195" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-196"><a href="#cb34-196" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-197"><a href="#cb34-197" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;geometric&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-198"><a href="#cb34-198" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-199"><a href="#cb34-199" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-200"><a href="#cb34-200" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-201"><a href="#cb34-201" tabindex="-1"></a></span>
<span id="cb34-202"><a href="#cb34-202" tabindex="-1"></a><span class="co">#hyper</span></span>
<span id="cb34-203"><a href="#cb34-203" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;hyper&quot;</span>, <span class="at">parameter =</span> .<span class="dv">6</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-204"><a href="#cb34-204" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-205"><a href="#cb34-205" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-206"><a href="#cb34-206" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-207"><a href="#cb34-207" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-208"><a href="#cb34-208" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-209"><a href="#cb34-209" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-210"><a href="#cb34-210" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-211"><a href="#cb34-211" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-212"><a href="#cb34-212" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-213"><a href="#cb34-213" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-214"><a href="#cb34-214" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-215"><a href="#cb34-215" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-216"><a href="#cb34-216" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-217"><a href="#cb34-217" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-218"><a href="#cb34-218" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-219"><a href="#cb34-219" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-220"><a href="#cb34-220" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-221"><a href="#cb34-221" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-222"><a href="#cb34-222" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-223"><a href="#cb34-223" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-224"><a href="#cb34-224" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-225"><a href="#cb34-225" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-226"><a href="#cb34-226" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;hyper&quot;</span>, <span class="at">parameter =</span> .<span class="dv">8</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-227"><a href="#cb34-227" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-228"><a href="#cb34-228" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-229"><a href="#cb34-229" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-230"><a href="#cb34-230" tabindex="-1"></a></span>
<span id="cb34-231"><a href="#cb34-231" tabindex="-1"></a><span class="co">#quadrilateral</span></span>
<span id="cb34-232"><a href="#cb34-232" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;quadrilateral&quot;</span>, <span class="at">parameter =</span> .<span class="dv">3</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-233"><a href="#cb34-233" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-234"><a href="#cb34-234" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-235"><a href="#cb34-235" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-236"><a href="#cb34-236" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-237"><a href="#cb34-237" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-238"><a href="#cb34-238" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-239"><a href="#cb34-239" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-240"><a href="#cb34-240" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-241"><a href="#cb34-241" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-242"><a href="#cb34-242" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-243"><a href="#cb34-243" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-244"><a href="#cb34-244" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-245"><a href="#cb34-245" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-246"><a href="#cb34-246" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-247"><a href="#cb34-247" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-248"><a href="#cb34-248" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-249"><a href="#cb34-249" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-250"><a href="#cb34-250" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-251"><a href="#cb34-251" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">modularity</span>(test<span class="sc">$</span>backbone, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>))) <span class="sc">&gt;</span> .<span class="dv">5</span>)  <span class="co">#Backbone has high modularity</span></span>
<span id="cb34-252"><a href="#cb34-252" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-253"><a href="#cb34-253" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::modularity(test$backbone, c(rep(1, 20), rep(2, </span></span>
<span id="cb34-254"><a href="#cb34-254" tabindex="-1"></a><span class="co">#&gt;  call| 20), rep(3, 20))) &gt; 0.5)</span></span>
<span id="cb34-255"><a href="#cb34-255" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;quadrilateral&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-256"><a href="#cb34-256" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Larger parameter yields more sparsification</span></span>
<span id="cb34-257"><a href="#cb34-257" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-258"><a href="#cb34-258" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span>
<span id="cb34-259"><a href="#cb34-259" tabindex="-1"></a></span>
<span id="cb34-260"><a href="#cb34-260" tabindex="-1"></a><span class="co">#degree</span></span>
<span id="cb34-261"><a href="#cb34-261" tabindex="-1"></a>U <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">sample_pa</span>(<span class="at">n =</span> <span class="dv">60</span>, <span class="at">m =</span> <span class="dv">3</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)  <span class="co">#A dense, scale-free network</span></span>
<span id="cb34-262"><a href="#cb34-262" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;degree&quot;</span>, <span class="at">parameter =</span> .<span class="dv">5</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-263"><a href="#cb34-263" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">4</span>)  <span class="co">#Returned object has four elements</span></span>
<span id="cb34-264"><a href="#cb34-264" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-265"><a href="#cb34-265" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(length(test) == 4)</span></span>
<span id="cb34-266"><a href="#cb34-266" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>narrative,<span class="st">&quot;character&quot;</span>))  <span class="co">#Narrative element is character class</span></span>
<span id="cb34-267"><a href="#cb34-267" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-268"><a href="#cb34-268" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$narrative, &quot;character&quot;))</span></span>
<span id="cb34-269"><a href="#cb34-269" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test<span class="sc">$</span>call,<span class="st">&quot;call&quot;</span>))  <span class="co">#Call element is call class</span></span>
<span id="cb34-270"><a href="#cb34-270" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-271"><a href="#cb34-271" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test$call, &quot;call&quot;))</span></span>
<span id="cb34-272"><a href="#cb34-272" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all.equal</span>(U,test<span class="sc">$</span>original))  <span class="co">#Original element matches starting graph</span></span>
<span id="cb34-273"><a href="#cb34-273" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-274"><a href="#cb34-274" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all.equal(U, test$original))</span></span>
<span id="cb34-275"><a href="#cb34-275" tabindex="-1"></a><span class="fu">expect_false</span>(igraph<span class="sc">::</span><span class="fu">is_weighted</span>(test<span class="sc">$</span>backbone))  <span class="co">#Backbone is unweighted</span></span>
<span id="cb34-276"><a href="#cb34-276" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-277"><a href="#cb34-277" tabindex="-1"></a><span class="co">#&gt;  call| expect_false(igraph::is_weighted(test$backbone))</span></span>
<span id="cb34-278"><a href="#cb34-278" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">gorder</span>(test<span class="sc">$</span>backbone)<span class="sc">==</span>igraph<span class="sc">::</span><span class="fu">gorder</span>(U))  <span class="co">#Backbone size matches original graph size</span></span>
<span id="cb34-279"><a href="#cb34-279" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-280"><a href="#cb34-280" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::gorder(test$backbone) == igraph::gorder(U))</span></span>
<span id="cb34-281"><a href="#cb34-281" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">which.max</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(U)) <span class="sc">==</span> <span class="fu">which.max</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(test<span class="sc">$</span>backbone)))  <span class="co">#Backbone preserves highest-degree node</span></span>
<span id="cb34-282"><a href="#cb34-282" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-283"><a href="#cb34-283" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(which.max(igraph::degree(U)) == which.max(igraph::degree(test$backbone)))</span></span>
<span id="cb34-284"><a href="#cb34-284" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">cor</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(U),igraph<span class="sc">::</span><span class="fu">degree</span>(test<span class="sc">$</span>backbone)) <span class="sc">&gt;</span> <span class="fl">0.75</span>)  <span class="co">#Backbone preserves degree distribution</span></span>
<span id="cb34-285"><a href="#cb34-285" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-286"><a href="#cb34-286" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(cor(igraph::degree(U), igraph::degree(test$backbone)) &gt; </span></span>
<span id="cb34-287"><a href="#cb34-287" tabindex="-1"></a><span class="co">#&gt;  call| 0.75)</span></span>
<span id="cb34-288"><a href="#cb34-288" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">backbone_from_unweighted</span>(U, <span class="at">model =</span> <span class="st">&quot;degree&quot;</span>, <span class="at">parameter =</span> .<span class="dv">2</span>, <span class="at">return =</span> <span class="st">&quot;everything&quot;</span>)</span>
<span id="cb34-289"><a href="#cb34-289" tabindex="-1"></a><span class="fu">expect_true</span>(igraph<span class="sc">::</span><span class="fu">edge_density</span>(test<span class="sc">$</span>backbone) <span class="sc">&gt;</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(test2<span class="sc">$</span>backbone))  <span class="co">#Smaller parameter yields more sparsification</span></span>
<span id="cb34-290"><a href="#cb34-290" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb34-291"><a href="#cb34-291" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(igraph::edge_density(test$backbone) &gt; igraph::edge_density(test2$backbone))</span></span></code></pre></div>
</div>
</div>
<div id="null" class="section level1">
<h1>Null model functions</h1>
<div id="sdsm" class="section level2">
<h2><code>.sdsm()</code></h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.sdsm</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="sdsm_ec" class="section level2">
<h2><code>.sdsm_ec()</code></h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">11</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.sdsm_ec</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="fixedrow" class="section level2">
<h2><code>.fixedrow()</code></h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.fixedrow</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="fixedcol" class="section level2">
<h2><code>.fixedcol()</code></h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.fixedcol</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="fixedfill" class="section level2">
<h2><code>.fixedfill()</code></h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.fixedfill</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="fdsm" class="section level2">
<h2><code>.fdsm()</code></h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.fdsm</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mtc =</span> <span class="st">&quot;none&quot;</span>, <span class="at">trials =</span> <span class="dv">1000</span>)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="co">#&gt; Constructing edges&#39; Monte Carlo p-values</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>upper))))  <span class="co">#Upper-tail diagonal is missing</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$upper))))</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">diag</span>(test<span class="sc">$</span>lower))))  <span class="co">#Lower-tail diagonal is missing</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(is.na(diag(test$lower))))</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>upper))  <span class="co">#Upper-tail is symmetric</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$upper))</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">isSymmetric</span>(test<span class="sc">$</span>lower))  <span class="co">#Lower-tail is symmetric</span></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(isSymmetric(test$lower))</span></span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="disparity" class="section level2">
<h2><code>.disparity()</code></h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.disparity</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="lans" class="section level2">
<h2><code>.lans()</code></h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.lans</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
<div id="mlf" class="section level2">
<h2><code>.mlf()</code></h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.mlf</span>(M, <span class="at">signed =</span> <span class="cn">TRUE</span>, <span class="at">missing_as_zero =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>test<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>upper,<span class="dv">3</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>test<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">round</span>(test<span class="sc">$</span>lower,<span class="dv">3</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">is</span>(test, <span class="st">&quot;list&quot;</span>) <span class="sc">&amp;</span> <span class="fu">length</span>(test)<span class="sc">==</span><span class="dv">2</span>)  <span class="co">#Output is a two-item list</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(is(test, &quot;list&quot;) &amp; length(test) == 2)</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>upper[<span class="fu">upper.tri</span>(test<span class="sc">$</span>upper)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Upper-tail p-values between 0 and 1</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$upper[upper.tri(test$upper)] &gt;= 0 &amp; test$upper[upper.tri(test$upper)] &lt;= </span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="fu">expect_true</span>(<span class="fu">all</span>(test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> test<span class="sc">$</span>lower[<span class="fu">upper.tri</span>(test<span class="sc">$</span>lower)]<span class="sc">&lt;=</span><span class="dv">1</span>))  <span class="co">#Lower-tail p-values between 0 and 1</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="co">#&gt;  call| expect_true(all(test$lower[upper.tri(test$lower)] &gt;= 0 &amp; test$lower[upper.tri(test$lower)] &lt;= </span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="co">#&gt;  call| 1))</span></span></code></pre></div>
</div>
</div>
<div id="utility" class="section level1">
<h1>Utility functions</h1>
<div id="bicm" class="section level2">
<h2><code>bicm()</code></h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">bicm</span>(M),<span class="dv">3</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="fu">expect_equal</span>(test, <span class="fu">rbind</span>(<span class="fu">c</span>(.<span class="dv">216</span>,.<span class="dv">216</span>,.<span class="dv">568</span>),<span class="fu">c</span>(.<span class="dv">216</span>,.<span class="dv">216</span>,.<span class="dv">568</span>),<span class="fu">c</span>(.<span class="dv">568</span>,.<span class="dv">568</span>,.<span class="dv">863</span>)))  <span class="co">#BiCM probabilities</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(test, rbind(c(0.216, 0.216, 0.568), c(0.216, 0.216, </span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co">#&gt;  call| 0.568), c(0.568, 0.568, 0.863)))</span></span></code></pre></div>
</div>
<div id="fastball" class="section level2">
<h2><code>fastball()</code></h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">1000</span>,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">fastball</span>(M)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">rowSums</span>(test), <span class="fu">rowSums</span>(M))  <span class="co">#Row sums match</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(rowSums(test), rowSums(M))</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="fu">colSums</span>(test), <span class="fu">colSums</span>(M))  <span class="co">#Column sums match</span></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(colSums(test), colSums(M))</span></span></code></pre></div>
</div>
<div id="retain" class="section level2">
<h2><code>.retain()</code></h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">02</span>,.<span class="dv">03</span>),  <span class="co">#Unsigned</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>               <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">06</span>,.<span class="dv">07</span>),</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>))</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">upper =</span> upper)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.retain</span>(p, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mtc =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="fu">expect_equal</span>(test, <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)))</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(test, rbind(c(0, 1, 1), c(0, 0, 0), c(0, 0, 0)))</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">02</span>,.<span class="dv">03</span>),  <span class="co">#Signed</span></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>               <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">06</span>,.<span class="dv">07</span>),</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>))</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>),</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>               <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">06</span>,.<span class="dv">07</span>),</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>               <span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">02</span>,.<span class="dv">03</span>))</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">lower =</span> lower, <span class="at">upper =</span> upper)</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>test <span class="ot">&lt;-</span> backbone<span class="sc">:::</span><span class="fu">.retain</span>(p, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">mtc =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#Higher alpha because this is a two-tailed test</span></span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a><span class="fu">expect_equal</span>(test, <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a><span class="co">#&gt; ----- PASSED      : &lt;--&gt;</span></span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a><span class="co">#&gt;  call| expect_equal(test, rbind(c(0, 1, 1), c(0, 0, 0), c(-1, -1, 0)))</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
